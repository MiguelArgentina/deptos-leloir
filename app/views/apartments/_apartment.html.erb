<div class="bg-white my-2 shadow-lg rounded-xl overflow-hidden border border-slate-100 transition hover:shadow-xl">
  <!-- Images carrousel -->
  <% if apartment.photos.attached? %>
    <div data-controller="carousel image-zoom" class="relative w-full overflow-hidden">
      <div data-carousel-target="carousel"
           class="flex transition-transform duration-500 ease-in-out w-full"
           style="transform: translateX(0%)">
        <% apartment.photos.each do |photo| %>
          <div class="w-full shrink-0">
            <%= image_tag photo.url(transformation: [{ height: 200, width: 400 }]),
                          data: {
                            "image-zoom-target": "zoomable",
                            zoomable: "",
                            "zoom-src": photo.url(transformation: [{ height: 800 }])
                          },
                          class: "w-full object-cover" %>
          </div>
        <% end %>
      </div>

      <!-- Prev Button -->
      <button type="button"
              data-action="click->carousel#prev"
              class="carousel-control absolute left-0 top-1/2 transform -translate-y-1/2 bg-white/70 hover:bg-white text-gray-600 px-2 py-1 z-10">
        ‹
      </button>

      <!-- Next Button -->
      <button type="button"
              data-action="click->carousel#next"
              class="carousel-control absolute right-0 top-1/2 transform -translate-y-1/2 bg-white/70 hover:bg-white text-gray-600 px-2 py-1 z-10">
        ›
      </button>
    </div>
  <% end %>

  <!-- End of Images carrousel -->

  <div class="p-5 space-y-2">
    <h2 class="text-xl font-semibold text-slate-700"><%= apartment.title %></h2>
    <p class="text-sm text-slate-500"><%= apartment.location %></p>
    <p class="text-sm text-slate-600 line-clamp-3"><%= apartment.description %></p>

    <div class="pt-4 flex flex-wrap gap-3">
      <% unless controller_name == "apartments" && action_name == "show" %>
        <!-- View -->
        <%= link_to apartment, class: "inline-flex items-center gap-x-2 rounded-md bg-transparent px-3.5 py-2.5 text-sm font-semibold text-gray-500 hover:text-blue-600 hover:bg-gray-100 transition" do %>
          <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5"
               stroke="currentColor" class="w-6 h-6 text-blue-300">
            <path stroke-linecap="round" stroke-linejoin="round"
                  d="M2.25 12s3.75-6.75 9.75-6.75S21.75 12 21.75 12s-3.75 6.75-9.75 6.75S2.25 12 2.25 12zm9.75 3.375a3.375 3.375 0 1 0 0-6.75 3.375 3.375 0 0 0 0 6.75z" />
          </svg>
          <span>Ver</span>
        <% end %>
      <% end %>

      <% if controller_name == "apartments" && action_name == "show" %>
        <a href="#contact-footer" class="inline-flex items-center gap-x-2 text-blue-600 underline font-semibold">
          <i class="fa fa-phone"></i>
          Contacto
        </a>
        <%= link_to "Ver en Google Maps", "https://www.google.com/maps/search/?api=1&query=#{CGI.escape(apartment.location)}", target: "_blank", rel: "noopener", class: "text-blue-700 underline" %>
      <% end %>


      <% if admin_signed_in? %>
        <div class="inline-flex">
        <!-- Edit -->
        <%= link_to edit_apartment_path(apartment), class: "inline-flex items-center gap-x-2 rounded-md bg-transparent px-3.5 py-2.5 text-sm font-semibold text-gray-500 hover:text-yellow-700 hover:bg-gray-100 transition" do %>
          <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5"
               stroke="currentColor" class="w-6 h-6 text-yellow-300">
            <path stroke-linecap="round" stroke-linejoin="round"
                  d="M16.862 4.487l1.687-1.687a1.875 1.875 0 1 1 2.652 2.652L7.5 19.125H3.75V15.37L16.862 4.487z" />
          </svg>
          <span>Editar</span>
        <% end %>

        <!-- Delete -->
        <%= button_to apartment, method: :delete, data: { turbo_confirm: "Are you sure?" },
                      class: "inline-flex items-center gap-x-2 rounded-md bg-transparent px-3.5 py-2.5 text-sm font-semibold text-gray-500 hover:text-red-600 hover:bg-gray-100 transition" do %>
          <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5"
               stroke="currentColor" class="w-6 h-6 text-red-300">
            <path stroke-linecap="round" stroke-linejoin="round" d="M6 18L18 6M6 6l12 12" />
          </svg>
          <span>Eliminar</span>
        <% end %>
        </div>
      <% end %>


    </div>
  </div>
</div>
<script>
    document.addEventListener('medium-zoom:opened', () => {
        document.body.classList.add('zoom-active');
    });

    document.addEventListener('medium-zoom:closed', () => {
        document.body.classList.remove('zoom-active');
    });
</script>